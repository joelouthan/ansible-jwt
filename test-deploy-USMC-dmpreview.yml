---
hosts: web1:web2:web3:web4
remote_user: jlouthan
vars:
        site: /var/www/dmpreview.marines.com/
        tag: 1.0.1
        makerev: /usr/local/jwt/bin/make_rev.sh
tasks:
      - name: git fetch and check branch
        shell: git fetch && git branch
        register: availtags
        args:
                chdir: {{ site }}

      - debug: var=availtags.stdout_lines

      - pause: prompt='Make sure branch/tag is available'

      - name: git checkout specified tag
        shell: git checkout {{ tag }}
        register: checkout
        
      - debug: var=checkout.stdout_lines

      - pause: prompt='Make sure all is well'

      - name: make rev
        shell: {{ makerev }}
